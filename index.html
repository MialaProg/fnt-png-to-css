<!DOCTYPE html>
<html>
<head>
  <title>Générateur de Police Bitmap</title>
  <style>
    :root {
      --scale-factor: 1; /* Variable CSS pour le contrôle de l'échelle */
    }

    #testArea {
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 24px;
    }

    /* Nouveaux styles pour le redimensionnement */
    .bitmap-font {
      transform: scale(var(--scale-factor));
      transform-origin: left bottom;
      margin-right: calc(-4em * var(--scale-factor)); /* Ajustement dynamique des marges */
      margin-bottom: calc(-5em * var(--scale-factor));
    }

    /* Options de taille prédéfinies */
    .size-option {
      display: inline-block;
      padding: 5px;
      margin: 5px;
      cursor: pointer;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  .fnt : <input type="file" id="fntFile" accept=".fnt" /><br>
  .png : <input type="file" id="pngFile" accept=".png" /><br>
  <button onclick="generateWebFont()">Générer la police</button><br>
  <button onclick="downloadCSS()" id="downloadBtn" disabled>Télécharger CSS</button>
  
  <!-- Ajout du curseur de taille -->
  <div style="margin: 15px 0">
    Taille: 
    <input type="range" 
           id="sizeSlider" 
           min="0.5" 
           max="3" 
           step="0.1" 
           value="1"
           oninput="updateScale(this.value)">
    <span id="scaleValue">1x</span>
  </div>

  <textarea id="testArea" placeholder="Tapez ici pour tester la police..." disabled></textarea>

  <script>
    // Nouvelle fonction pour gérer le redimensionnement
    function updateScale(value) {
      document.documentElement.style.setProperty('--scale-factor', value);
      document.getElementById('scaleValue').textContent = value + 'x';
    }

    // Le reste du script reste inchangé...
    let currentChars = [];
    let generatedCSS = '';

    async function generateWebFont() {
      const fntFile = document.getElementById('fntFile').files[0];
      const pngFile = document.getElementById('pngFile').files[0];

      if (!fntFile || !pngFile) {
        alert("Veuillez sélectionner les deux fichiers !");
        return;
      }

      const fntText = await fntFile.text();
      currentChars = parseFNT(fntText);
      const pngDataURL = await readFileAsDataURL(pngFile);

      injectCSS(currentChars, pngDataURL);
      document.getElementById('downloadBtn').disabled = false;
      document.getElementById('testArea').disabled = false;
    }

    function parseFNT(fntText) {
      const chars = [];
      const lines = fntText.split("\n");

      for (const line of lines) {
        if (line.startsWith("char ")) {
          const parts = line.split(/\s+/).reduce((acc, part) => {
            const [key, val] = part.split("=");
            if (val) acc[key] = parseInt(val);
            return acc;
          }, {});
          chars.push(parts);
        }
      }
      return chars;
    }

    function injectCSS(chars, pngDataURL) {
      let css = `.bitmap-font {
  display: inline-block;
  background-image: url('${pngDataURL}');
  image-rendering: pixelated;
  vertical-align: bottom;
}\n\n`;

      chars.forEach(char => {
        css += `.char-${char.id} {
  width: ${char.width}px;
  height: ${char.height}px;
  background-position: -${char.x}px -${char.y}px;
}\n`;
      });

      const style = document.createElement('style');
      style.textContent = css;
      document.head.appendChild(style);
      generatedCSS = css;
    }

    // Le reste des fonctions reste inchangé...
    // ... (downloadCSS, event listener, readFileAsDataURL)
  </script>
</body>
</html>